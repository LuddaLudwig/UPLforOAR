% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Bayesian_UPL.R
\name{Bayesian_UPL}
\alias{Bayesian_UPL}
\title{Bayesian_UPL() wraps \code{\link[=setup_likelihood]{setup_likelihood()}}, \code{\link[=run_likelihood]{run_likelihood()}},
\code{\link[=output_likelihood]{output_likelihood()}}, \code{\link[=converge_likelihood]{converge_likelihood()}}, and \code{\link[=fit_likelihood]{fit_likelihood()}}}
\usage{
Bayesian_UPL(
  distr_list = c("Normal", "Skewed", "Lognormal", "Gamma", "Beta"),
  data,
  future_runs = 3,
  significance = 0.99,
  xvals = NULL,
  maxY = NULL,
  convergence_report = FALSE,
  manual_prior = FALSE,
  prior_list = NULL
)
}
\arguments{
\item{distr_list}{A list including one or more of
\code{c('Normal','Skewed','Lognormal','Gamma','Beta')}. Note that if prior bounds
are supplied manually, only one distribution can be used.}

\item{data}{Emissions data from either the best source or top performers,
must have a column named 'emissions'.}

\item{future_runs}{Integer of future runs to use in prediction, the default
is \code{3} since compliance uses 1 test average of 3 runs.}

\item{significance}{Level of significance from 0 to 1, the default is \code{0.99}.}

\item{xvals}{Ordered sequence of emissions at which to predict probability
density. Default is \code{NULL}, in which case \code{x_hat} is a 1024 length sequence
between \code{0} and \code{3*max(data$emissions)}.}

\item{maxY}{The maximum emission value possible, used to truncate likelihood
distributions and set upper ranges on prior distributions, not specified
manually. Default is \code{NULL}, in which case is is calculated as \code{3*max(data$emissions)}.}

\item{convergence_report}{Default is \code{FALSE}, if a report containing
convergence figures should be generated with results. If \code{TRUE}, a document
Bayesian_UPL_convergence_MMDDYYY_HHMM.pdf will be written to the current
working directory.}

\item{manual_prior}{Default is \code{FALSE}, if priors should be specified manually
or be uninformative calculated from range of emissions data. Note that if you
are supplying priors manually than you can only run one type of distribution
at a time.}

\item{prior_list}{Optional list of \code{\link[stats:Uniform]{stats::dunif()}} upper and lower bounds for prior
distributions. For \code{'Normal'} they are ordered \verb{c(sd_low, sd_high, mean_low,mean_high')}.
For \code{'Lognormal'} they are ordered \code{c(log_sd_low, log_sd_high, log_mean_low, log_mean_high)}.
For \code{'Skewed'} they are ordered \code{c(omega_low, omega_high, xi_low, xi_high, alpha_low, alpha_high)}.
For \code{'Gamma'} they are ordered \code{c(rate_low, rate_high, shape_low, shape_high)}. For
\code{'Beta'} they are ordered \code{c(alpha_low, alpha_high, beta_low, beta_high)}.}
}
\value{
A list of tibble results from \code{\link[=setup_likelihood]{setup_likelihood()}}, \code{\link[=run_likelihood]{run_likelihood()}},
\code{\link[=output_likelihood]{output_likelihood()}}, \code{\link[=obs_density]{obs_density()}}, \code{\link[=fit_likelihood]{fit_likelihood()}}, and
\code{\link[=converge_likelihood]{converge_likelihood()}} for each distribution in \code{distr_list}.
}
\description{
For each distribution in \code{distr_list}, \code{\link[=Bayesian_UPL]{Bayesian_UPL()}} will \code{\link[=setup_likelihood]{setup_likelihood()}},
\code{\link[=run_likelihood]{run_likelihood()}}, organize mcmc results in \code{\link[=output_likelihood]{output_likelihood()}}, test for
convergence of likelihood parameters using \code{\link[=converge_likelihood]{converge_likelihood()}}, and
calculate goodness of fit metrics using \code{\link[=fit_likelihood]{fit_likelihood()}}. Results include
\verb{$fit_table}: a tibble with the \code{UPL}, \code{pdf_integral}, \code{SSE}, and count of
observations within 95\\% CI for each distribution in \code{'distr_list'},
\verb{$conv_output}: a tibble with the parameters, Gelman-Rubin diagnostics, and if
the converged for distribution in \code{distr_list}, \verb{$obs_pdf_dat}: a tibble with
the emissions observations, corresponding observation densities, median,
upper, and lower 95\\% CI around predicted densities for the distribution in
\code{distr_list}, and a 1 if the observation is within the 95\\% CI, a 0 otherwise,
and \verb{$pred_pdf_dat}:a tibble with the predicted probability density \code{pdf_hat},
the observation density \code{ydens} for each value in the range of emissions in
\code{x_hat}. The maximum emission value of distributions, \code{maxY}, the ordered range
emissions to predict to \code{xvals}, and the prior distributions and initial
values are all automatically supplied from the emissions data to be fully
encompassing and uninformative by default. They can be supplied manually
instead however by supplying \code{maxY}, \code{xvals}, or setting \code{manual_prior = TRUE}
with corresponding lower and upper limits in \code{prior_list}. If manual priors
are used, only a single distribution can be run at a time in \code{distr_list}.
}
