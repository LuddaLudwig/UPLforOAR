<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian_UPL() wraps setup_likelihood(), run_likelihood(), output_likelihood(), converge_likelihood(), and fit_likelihood() — Bayesian_UPL • UPLforOAR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian_UPL() wraps setup_likelihood(), run_likelihood(), output_likelihood(), converge_likelihood(), and fit_likelihood() — Bayesian_UPL"><meta name="description" content="For each distribution in distr_list, Bayesian_UPL() will setup_likelihood(),
run_likelihood(), organize mcmc results in output_likelihood(), test for
convergence of likelihood parameters using converge_likelihood(), and
calculate goodness of fit metrics using fit_likelihood(). Results include
$fit_table: a tibble with the UPL, pdf_integral, SSE, and count of
observations within 95\
$conv_output: a tibble with the parameters, Gelman-Rubin diagnostics, and if
the converged for distribution in distr_list, $obs_pdf_dat: a tibble with
the emissions observations, corresponding observation densities, median,
upper, and lower 95\
distr_list, and a 1 if the observation is within the 95\
and $pred_pdf_dat:a tibble with the predicted probability density pdf_hat,
the observation density ydens for each value in the range of emissions in
x_hat. The maximum emission value of distributions, maxY, the ordered range
emissions to predict to xvals, and the prior distributions and initial
values are all automatically supplied from the emissions data to be fully
encompassing and uninformative by default. They can be supplied manually
instead however by supplying maxY, xvals, or setting manual_prior = TRUE
with corresponding lower and upper limits in prior_list. If manual priors
are used, only a single distribution can be run at a time in distr_list."><meta property="og:description" content="For each distribution in distr_list, Bayesian_UPL() will setup_likelihood(),
run_likelihood(), organize mcmc results in output_likelihood(), test for
convergence of likelihood parameters using converge_likelihood(), and
calculate goodness of fit metrics using fit_likelihood(). Results include
$fit_table: a tibble with the UPL, pdf_integral, SSE, and count of
observations within 95\
$conv_output: a tibble with the parameters, Gelman-Rubin diagnostics, and if
the converged for distribution in distr_list, $obs_pdf_dat: a tibble with
the emissions observations, corresponding observation densities, median,
upper, and lower 95\
distr_list, and a 1 if the observation is within the 95\
and $pred_pdf_dat:a tibble with the predicted probability density pdf_hat,
the observation density ydens for each value in the range of emissions in
x_hat. The maximum emission value of distributions, maxY, the ordered range
emissions to predict to xvals, and the prior distributions and initial
values are all automatically supplied from the emissions data to be fully
encompassing and uninformative by default. They can be supplied manually
instead however by supplying maxY, xvals, or setting manual_prior = TRUE
with corresponding lower and upper limits in prior_list. If manual priors
are used, only a single distribution can be run at a time in distr_list."><meta property="og:image" content="https://luddaludwig.github.io/UPLforOAR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">UPLforOAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Bayesian-UPL.html">Bayesian UPL</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/USEPA/UPLforOAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian_UPL() wraps <code><a href="setup_likelihood.html">setup_likelihood()</a></code>, <code><a href="run_likelihood.html">run_likelihood()</a></code>, <code><a href="output_likelihood.html">output_likelihood()</a></code>, <code><a href="converge_likelihood.html">converge_likelihood()</a></code>, and <code><a href="fit_likelihood.html">fit_likelihood()</a></code></h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/UPLforOAR/blob/main/R/Bayesian_UPL.R" class="external-link"><code>R/Bayesian_UPL.R</code></a></small>
      <div class="d-none name"><code>Bayesian_UPL.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For each distribution in <code>distr_list</code>, <code>Bayesian_UPL()</code> will <code><a href="setup_likelihood.html">setup_likelihood()</a></code>,
<code><a href="run_likelihood.html">run_likelihood()</a></code>, organize mcmc results in <code><a href="output_likelihood.html">output_likelihood()</a></code>, test for
convergence of likelihood parameters using <code><a href="converge_likelihood.html">converge_likelihood()</a></code>, and
calculate goodness of fit metrics using <code><a href="fit_likelihood.html">fit_likelihood()</a></code>. Results include
<code>$fit_table</code>: a tibble with the <code>UPL</code>, <code>pdf_integral</code>, <code>SSE</code>, and count of
observations within 95\<!-- % CI for each distribution in \code{'distr_list'}, -->
<code>$conv_output</code>: a tibble with the parameters, Gelman-Rubin diagnostics, and if
the converged for distribution in <code>distr_list</code>, <code>$obs_pdf_dat</code>: a tibble with
the emissions observations, corresponding observation densities, median,
upper, and lower 95\<!-- % CI around predicted densities for the distribution in -->
<code>distr_list</code>, and a 1 if the observation is within the 95\<!-- % CI, a 0 otherwise, -->
and <code>$pred_pdf_dat</code>:a tibble with the predicted probability density <code>pdf_hat</code>,
the observation density <code>ydens</code> for each value in the range of emissions in
<code>x_hat</code>. The maximum emission value of distributions, <code>maxY</code>, the ordered range
emissions to predict to <code>xvals</code>, and the prior distributions and initial
values are all automatically supplied from the emissions data to be fully
encompassing and uninformative by default. They can be supplied manually
instead however by supplying <code>maxY</code>, <code>xvals</code>, or setting <code>manual_prior = TRUE</code>
with corresponding lower and upper limits in <code>prior_list</code>. If manual priors
are used, only a single distribution can be run at a time in <code>distr_list</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Bayesian_UPL</span><span class="op">(</span></span>
<span>  distr_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span>, <span class="st">"Skewed"</span>, <span class="st">"Lognormal"</span>, <span class="st">"Gamma"</span>, <span class="st">"Beta"</span><span class="op">)</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  future_tests <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  significance <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  xvals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxY <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  convergence_report <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  manual_prior <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prior_list <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-distr-list">distr_list<a class="anchor" aria-label="anchor" href="#arg-distr-list"></a></dt>
<dd><p>A list including one or more of
<code>c('Normal','Skewed','Lognormal','Gamma','Beta')</code>. Note that if prior bounds
are supplied manually, only one distribution can be used.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Emissions data from either the best source or top performers,
must have a column named 'emissions'.</p></dd>


<dt id="arg-future-tests">future_tests<a class="anchor" aria-label="anchor" href="#arg-future-tests"></a></dt>
<dd><p>Integer of future runs to use in prediction, the default
is <code>3</code> since compliance uses 1 test average of 3 runs.</p></dd>


<dt id="arg-significance">significance<a class="anchor" aria-label="anchor" href="#arg-significance"></a></dt>
<dd><p>Level of significance from 0 to 1, the default is <code>0.99</code>.</p></dd>


<dt id="arg-xvals">xvals<a class="anchor" aria-label="anchor" href="#arg-xvals"></a></dt>
<dd><p>Ordered sequence of emissions at which to predict probability
density. Default is <code>NULL</code>, in which case <code>x_hat</code> is a 1024 length sequence
between <code>0</code> and <code>3*max(data$emissions)</code>.</p></dd>


<dt id="arg-maxy">maxY<a class="anchor" aria-label="anchor" href="#arg-maxy"></a></dt>
<dd><p>The maximum emission value possible, used to truncate likelihood
distributions and set upper ranges on prior distributions, not specified
manually. Default is <code>NULL</code>, in which case is is calculated as <code>3*max(data$emissions)</code>.</p></dd>


<dt id="arg-convergence-report">convergence_report<a class="anchor" aria-label="anchor" href="#arg-convergence-report"></a></dt>
<dd><p>Default is <code>FALSE</code>, if a report containing
convergence figures should be generated with results. If <code>TRUE</code>, a document
Bayesian_UPL_convergence_MMDDYYY_HHMM.pdf will be written to the current
working directory.</p></dd>


<dt id="arg-manual-prior">manual_prior<a class="anchor" aria-label="anchor" href="#arg-manual-prior"></a></dt>
<dd><p>Default is <code>FALSE</code>, if priors should be specified manually
or be uninformative calculated from range of emissions data. Note that if you
are supplying priors manually than you can only run one type of distribution
at a time.</p></dd>


<dt id="arg-prior-list">prior_list<a class="anchor" aria-label="anchor" href="#arg-prior-list"></a></dt>
<dd><p>Optional list of <code><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">stats::dunif()</a></code> upper and lower bounds for prior
distributions. For <code>'Normal'</code> they are ordered <code>c(sd_low, sd_high, mean_low,mean_high')</code>.
For <code>'Lognormal'</code> they are ordered <code>c(log_sd_low, log_sd_high, log_mean_low, log_mean_high)</code>.
For <code>'Skewed'</code> they are ordered <code>c(omega_low, omega_high, xi_low, xi_high, alpha_low, alpha_high)</code>.
For <code>'Gamma'</code> they are ordered <code>c(rate_low, rate_high, shape_low, shape_high)</code>. For
<code>'Beta'</code> they are ordered <code>c(alpha_low, alpha_high, beta_low, beta_high)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of tibble results from <code><a href="setup_likelihood.html">setup_likelihood()</a></code>, <code><a href="run_likelihood.html">run_likelihood()</a></code>,
<code><a href="output_likelihood.html">output_likelihood()</a></code>, <code><a href="obs_density.html">obs_density()</a></code>, <code><a href="fit_likelihood.html">fit_likelihood()</a></code>, and
<code><a href="converge_likelihood.html">converge_likelihood()</a></code> for each distribution in <code>distr_list</code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ludda Ludwig.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

